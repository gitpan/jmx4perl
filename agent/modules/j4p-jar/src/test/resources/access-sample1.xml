<?xml version="1.0" encoding="UTF-8"?>

<!--
  Sample definitions for restricting the access to the j4p-agent. Adapt this
  file and copy it over to 'restrict_access.xml', which get's evaluated during
  runtime (if included in the war).

  You can restrict the available methods in principale as well as the accessible
  attributes and operations in detail.
-->

<j4p-restrict>
  <!-- List of allowed commands. Remove the commands you dont want to
       be called. If the section <commands> is missing completely, all
       commands are allowed -->
  <commands>
    <command>read</command>
    <command>write</command>
    <command>exec</command>
    <command>list</command>
    <command>version</command>
    <command>search</command>
  </commands>

  <!-- Access to the following MBeans with their attributes/operations is allowed. If the
       <mbeans> sections is present, access to any MBean not mentioned there will be
       rejected. If the <mbeans> section is missing, access to all MBeans is allowed -->
  <mbeans>
    <mbean>
      <name>java.lang:type=Memory</name>
      <attribute>HeapMemoryUsage</attribute>
      <attribute mode="read"> Verbose </attribute>
      <operation>gc</operation>
    </mbean>
    <mbean>
      <name>java.lang:type=Threading</name>
      <attribute>ThreadCount</attribute>
    </mbean>
  </mbeans>
</j4p-restrict>
